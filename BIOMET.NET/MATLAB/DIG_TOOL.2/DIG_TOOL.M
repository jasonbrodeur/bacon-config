% script dig_tool.m
%
% Inputs:
%       a figure created by autoimg.m function
%
%
% Outputs:
%       k:          point counter initialized to 0
%       x:          x coordinates array
%       y:          y coordinates array
%       PointOld:   the coordinates of the last point taken of the screen
%       cb_frame:   handle for the 'Tools' frame object
%       cb_title:   handle for the title ('Tools')
%       cb_zoom:    handle for the Zoom checkbox
%       cb_x:       handle for the 'x = ' string
%       cb_y:       handle for the 'y = ' string
%       cb_n:       handle for the 'n = ' string
%       cb_del:     handle for the 'Delete' push-button
%       cb_del_all: handle for the 'Del Lin' push-button
%       'WindowButtonUpFcn' callback function is set to getp.m
%
% Comment:
%       dig_tool.m is the initialization script for the digitizer toolbox made for
%       BIOMET group at UBC. It should be called imediately after an image has been
%       created. It creates a GUI interface that enables the user to select 
%       zoom or data collection mode (zoom and data checkboxes), shows the
%       number of points collected up to that moment and the coordinates of 
%       the last point. The cursor is set to 'cross_hair'. The callbacks are:
%                   getp.m
%                   dl_point.m
%                   dl_line.m
%                   int_hand.m
%
%
% (c) 1995, Zoran Nesic
%
%
k = 0;                                  % initialize the counter and the data arrays
x=[];
y=[];
cb_plot =[];
PointOld = get(gca,'CurrentPoint');     % and the current point

int_states = [ 0 1];                    % initial states of [zoom data] checkboxes
color_bg =  [ 1 1 1] ;
cb_frame = uicontrol( gcf,...                           % Create all the uicontrol objects
                    'style', 'frame',...
                    'position',[8 8 110 160],...
                    'BackgroundColor',color_bg * 0.8);
cb_title = uicontrol( gcf,...
                    'style','text',...
                    'position',[20 150 70 15],...
                    'string','Tools',...
                    'BackgroundColor',[ 1 1 1]); 

cb_zoom = uicontrol( gcf,...
                    'style', 'checkbox',...
                    'position',[20 120 80 20],...
                    'string','Zoom',...
                    'callback','int_hand',...
                    'value', int_states(1),...
                    'BackgroundColor',[.9 .9 .9] );

cb_data = uicontrol( gcf,...
                    'style', 'checkbox',...
                    'position',[20 90 80 20],...
                    'string','Data',...
                    'callback','int_hand',...
                    'value',int_states(2),...
                    'BackgroundColor',[.9 .9 .9]);
cb_x =    uicontrol( gcf,...
                    'style','text',...
                    'position',[20 70 90 17],...
                    'string','x =            ',...
                    'HorizontalAlignment','left',...
                    'BackgroundColor',color_bg * 0.8);                     
cb_y =    uicontrol( gcf,...
                    'style','text',...
                    'position',[20 45 90 17],...
                    'string','y =            ',...
                    'HorizontalAlignment','left',...
                    'BackgroundColor',color_bg * 0.8);                     
cb_n =    uicontrol( gcf,...
                    'style','text',...
                    'position',[20 20 90 17],...
                    'string','n =         0',...
                    'HorizontalAlignment','left',...
                    'BackgroundColor',color_bg * 0.8);                     
cb_del = uicontrol( gcf,...
                    'style','push',...
                    'position',[20 200 70 30],...
                    'string','Delete',...
                    'HorizontalAlignment','center',...
                    'CallBack','[ k, x, y, cb_plot] = dl_point(k, x, y, cb_plot, cb);');
cb_del_all= uicontrol( gcf,...
                    'style','push',...
                    'position',[20 400 70 30],...
                    'string','Del Line',...
                    'HorizontalAlignment','center',...
                    'CallBack','[ k, x, y, cb_plot] = dl_line(k, x, y, cb_plot, cb);');

cb = [cb_x cb_y cb_n];          % vector of handles
%
% Callback function for the mouse button (set to getp.m)
%
set(f1,'WindowButtonUpFcn','[PointOld, k, x, y, cb_plot] = getp(PointOld, k, x, y, cb,cb_plot );');
%
% Set pointer to 'crosshair'
%
set(f1,'pointer','crosshair');                    
